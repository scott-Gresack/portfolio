<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#1E40AF" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="https://scott-gresack.github.io/portfolio/icons/icon-192x192.png">

  <title>üì± Mobile Tag Spec Builder | Scott Gresack</title>
  <meta name="description" content="Build and simulate Adobe Mobile SDK payloads with real-time validation. Supports Swift, Kotlin, Edge.sendEvent, and XDM." />
  <meta name="keywords" content="Mobile Tag Spec, Adobe Mobile SDK, Edge.sendEvent, trackAction, XDM, Swift, Kotlin, AEP, CDP, Scott Gresack" />
  <meta name="author" content="Scott Gresack" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://scott-gresack.github.io/portfolio/mobile_updates" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://scott-gresack.github.io/portfolio/mobile_updates" />
  <meta property="og:title" content="Mobile Tag Spec Builder | Scott Gresack Portfolio" />
  <meta property="og:description" content="Generate Adobe Mobile SDK payloads. Swift & Kotlin code snippets for Edge events and XDM validation. By Scott Gresack." />
  <meta property="og:image" content="https://scott-gresack.github.io/portfolio/assets/preview-image.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Mobile Tag Spec Builder | Scott Gresack" />
  <meta name="twitter:description" content="Interactive tool for creating and simulating mobile analytics events with Adobe AEP SDK." />
  <meta name="twitter:image" content="https://scott-gresack.github.io/portfolio/assets/preview-image.png" />

  <script defer src="https://www.googletagmanager.com/gtag/js?id=GT-MQBSZT8H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GT-MQBSZT8H');
  </script>

  <script defer type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Mobile Tag Spec Builder",
    "applicationCategory": "DeveloperTool",
    "operatingSystem": "Web",
    "url": "https://scott-gresack.github.io/portfolio/mobile_updates",
    "author": {
      "@type": "Person",
      "name": "Scott Gresack"
    }
  }
  </script>

  <script defer>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"};o="init capture identify alias".split(" ");for(n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
    posthog.init('phc_poY0XlVu6WBmOsIKW4OwRT60oDXKjJrMhPz1tqhvK6U', { api_host: 'https://us.i.posthog.com' });
  </script>

  <script defer>
    (function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y)})(window,document,"clarity","script","pmp4efispy");
  </script>

  <script defer>
    (function(window,document,dataLayerName,id){
      window[dataLayerName]=window[dataLayerName]||[],window[dataLayerName].push({start:(new Date).getTime(),event:"stg.start"});
      var scripts=document.getElementsByTagName('script')[0],tags=document.createElement('script');
      tags.async=!0;tags.src="https://scott-gresack.containers.piwik.pro/40c8a729-ebc6-4dfe-98be-6617064e43a9.js";
      scripts.parentNode.insertBefore(tags,scripts);
    })(window,document,'dataLayer','40c8a729-ebc6-4dfe-98be-6617064e43a9');
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <style>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeInUp { animation: fadeInUp 0.6s ease-out forwards; }
  </style>
</head>

<body class="bg-white text-gray-900 font-sans antialiased leading-relaxed tracking-wide">

  <header class="bg-white shadow sticky top-0 z-50 text-gray-900">
    <nav class="max-w-7xl mx-auto px-4 py-4 flex justify-between text-sm font-medium">
      <div class="font-semibold">Scott Gresack</div>
      <div class="space-x-4">
        <a href="https://scott-gresack.github.io/portfolio/" class="hover:text-blue-600 transition">Home</a>
        <a href="https://scott-gresack.github.io/portfolio/tool2.html" class="hover:text-blue-600 transition">Alloy Tool</a>
        <a href="https://scott-gresack.github.io/portfolio/xdm_comparator" class="hover:text-blue-600 transition">XDM Comparator</a>
        <a href="https://scott-gresack.github.io/portfolio/tag_spec_generator" class="hover:text-blue-600 transition">Tag Spec Tool</a>
      </div>
    </nav>
  </header>

  <main class="flex flex-col items-center justify-center min-h-screen px-4 pb-24 animate-fadeInUp">
    <div class="w-full max-w-3xl bg-white rounded-3xl shadow-2xl overflow-hidden border border-gray-200">
      <div class="bg-gradient-to-r from-blue-700 via-blue-600 to-blue-500 text-white p-8 rounded-t-3xl">
        <h1 class="text-4xl font-extrabold tracking-tight">üì± Mobile Tag Spec Builder</h1>
        <p class="mt-2 text-blue-100">Dynamically build <code>trackAction</code>, <code>trackState</code>, and Edge events with XDM preview.</p>
      </div>
      <div class="p-8 space-y-8">
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-900 space-y-2">
          <h2 class="text-base font-semibold text-blue-800">üß≠ How to Use This Tool (End-to-End)</h2>
          <ul class="list-disc list-inside space-y-1">
            <li>Select a tracking type: <code class="bg-blue-100 px-1 rounded">trackAction</code>, <code class="bg-blue-100 px-1 rounded">trackState</code>, or <code class="bg-blue-100 px-1 rounded">Edge.sendEvent</code>.</li>
            <li>Add any key-value pairs relevant to your mobile event context (e.g. screen name, feature flags).</li>
            <li>Use the XDM tab to add Adobe Experience Platform fields or schema-specific values.</li>
            <li>Preview the generated payload ‚Äî it will reflect your session and user context.</li>
            <li>Copy the payload for use in your native app (Swift or Kotlin) or for QA validation.</li>
            <li>Session data and PostHog logs help you validate behavior against backend or CJA.</li>
            <li>Choose your SDK style (e.g., AEPEdgeBridge vs MobileCore) to see native API formats for iOS, Android, and React Native.</li>
          </ul>
        </div>
        <div id="root"></div>
        <noscript class="text-center text-red-500 text-sm mt-4">Please enable JavaScript to use this tool.</noscript>
      </div>
      <footer class="bg-gray-50 text-gray-600 p-4 text-center rounded-b-3xl border-t text-sm">
        Built with ‚ù§Ô∏è by <a href="https://scott-gresack.github.io/portfolio/" class="text-blue-600 hover:underline">Scott Gresack</a>
      </footer>
    </div>
  </main>

<script>
  const { createApp, ref, computed, onMounted, watch } = Vue;

  createApp({
    setup() {
      const eventType = ref('trackAction');
      const keyValues = ref([{ key: '', value: '' }]);
      const overrideDatastream = ref(false);
      const datastreamId = ref('');
      const sendIdentityMap = ref(false);
      const identityNamespace = ref('email');
      const identityId = ref('user@example.com');
      const apiStyle = ref('bridge'); // 'bridge', 'core', 'legacy'

      const copied = ref('');

      const addKeyValue = () => keyValues.value.push({ key: '', value: '' });

      const jsonPayload = computed(() => {
        const base = {};
        keyValues.value.forEach(({ key, value }) => {
          if (key) base[key] = value;
        });
        return base;
      });

      const swiftCode = computed(() => {
        const payload = JSON.stringify(jsonPayload.value, null, 2);
        if (apiStyle.value === 'bridge') {
          return `AEPEdgeBridge.sendEvent(with: ${payload})`;
        } else {
          return `ACPExtension.${eventType.value}(withData: ${payload})`;
        }
      });

      const kotlinCode = computed(() => {
        if (apiStyle.value === 'bridge') {
          return `AEPEdgeBridge.sendEvent(mapOf(${Object.entries(jsonPayload.value).map(([k, v]) => `"${k}" to "${v}"`).join(',\n  ')}))`;
        } else {
          return `MobileCore.${eventType.value}(mapOf(${Object.entries(jsonPayload.value).map(([k, v]) => `"${k}" to "${v}"`).join(',\n  ')}))`;
        }
      });

      const reactNativeCode = computed(() => {
        const payload = JSON.stringify(jsonPayload.value, null, 2);
        if (apiStyle.value === 'bridge') {
          return `AEPEdgeBridge.sendEvent(${payload});`;
        } else {
          return `ACPExtension.${eventType.value}(${payload});`;
        }
      });

      const overridesCode = computed(() => {
        const parts = [];
        if (overrideDatastream.value && datastreamId.value) {
          parts.push(`datastreamId: "${datastreamId.value}"`);
        }
        if (sendIdentityMap.value && identityNamespace.value && identityId.value) {
          parts.push(`identityMap: { "${identityNamespace.value}": [{ id: "${identityId.value}", authenticatedState: "ambiguous", primary: true }] }`);
        }
        return parts.length ? `{ ${parts.join(', ')} }` : 'None';
      });

      const copyToClipboard = (content, label) => {
        navigator.clipboard.writeText(content).then(() => {
          copied.value = `‚úÖ Copied ${label}`;
          setTimeout(() => copied.value = '', 2000);
        });
      };

      onMounted(() => {
        const saved = localStorage.getItem('mobilePayload');
        if (saved) keyValues.value = JSON.parse(saved);
      });

      watch(jsonPayload, (val) => {
        localStorage.setItem('mobilePayload', JSON.stringify(keyValues.value));
      });

      return {
        eventType,
        keyValues,
        overrideDatastream,
        datastreamId,
        sendIdentityMap,
        identityNamespace,
        identityId,
        apiStyle,
        jsonPayload,
        addKeyValue,
        swiftCode,
        kotlinCode,
        reactNativeCode,
        overridesCode,
        copyToClipboard,
        copied
      };
    },
    template: `
      <div class="space-y-6">
        <!-- Event type dropdown -->
        <div>
          <label class="block font-semibold">Event Type</label>
          <select v-model="eventType" class="w-full border rounded p-2">
            <option value="trackAction">trackAction</option>
            <option value="trackState">trackState</option>
            <option value="sendEvent">Edge.sendEvent</option>
          </select>
          <p class="text-xs text-gray-500 mt-1">
            Choose which method you want to simulate. <code>trackAction</code> and <code>trackState</code> are standard mobile analytics events. Use <code>sendEvent</code> for Adobe Edge Network calls with XDM.
          </p>
        </div>

        <div class="space-y-2">
          <label class="block font-semibold">üìö SDK API Style</label>
          <select v-model="apiStyle" class="w-full border rounded p-2">
            <option value="bridge">AEPEdgeBridge (Modern)</option>
            <option value="core">ACPExtension / MobileCore</option>
            <option value="legacy">Legacy Objective-C Syntax (soon)</option>
          </select>
          <p class="text-xs text-gray-500 mt-1">
            Select the SDK integration method. <code>AEPEdgeBridge</code> reflects v4+ API for Swift and Kotlin. <code>ACPExtension</code> and <code>MobileCore</code> are legacy wrappers. Use this to match your app's SDK version.
          </p>
        </div>

        <!-- Context data -->
        <div>
          <label class="block font-semibold mb-2">Context Key-Value Pairs</label>
          <p class="text-xs text-gray-500 mt-1">
            These represent your event's context data ‚Äî anything from screen names to custom flags. They map directly into the payload structure.
          </p>
          <div v-for="(pair, index) in keyValues" :key="index" class="flex space-x-2 mb-2">
            <input v-model="pair.key" class="border p-2 rounded w-1/2" placeholder="key" />
            <input v-model="pair.value" class="border p-2 rounded w-1/2" placeholder="value" />
          </div>
          <button @click="addKeyValue" class="text-sm text-blue-600 hover:underline">+ Add Pair</button>
        </div>

        <!-- Optional AEP controls -->
        <div class="border-t pt-4 space-y-4">
          <label class="font-semibold block">‚öôÔ∏è Adobe Edge Overrides</label>
          <label class="flex items-center space-x-2">
            <input type="checkbox" v-model="overrideDatastream" />
            <span>Override Datastream ID</span>
          </label>
          <input v-if="overrideDatastream" v-model="datastreamId" class="border p-2 rounded w-full" placeholder="Datastream ID" />
          <p v-if="overrideDatastream" class="text-xs text-gray-500">
            Use this if you want to route the event to a different Adobe Datastream (e.g. for QA, staging, or a separate sandbox).
          </p>

          <label class="flex items-center space-x-2 mt-2">
            <input type="checkbox" v-model="sendIdentityMap" />
            <span>Send identityMap</span>
          </label>
          <div v-if="sendIdentityMap" class="space-y-2">
            <input v-model="identityNamespace" class="border p-2 rounded w-full" placeholder="Namespace (e.g. email, ECID, username)" />
            <input v-model="identityId" class="border p-2 rounded w-full" placeholder="ID Value (e.g. user@example.com)" />
            <p class="text-xs text-gray-500">
              The identityMap sends user identifiers like ECID, email, or custom namespaces to Adobe Edge. This enables identity resolution, personalization, and profile stitching across channels.
            </p>
          </div>
        </div>

        <!-- Live JSON output -->
        <div class="bg-gray-50 border p-4 rounded">
          <label class="font-semibold block mb-2">Generated Payload</label>
          <pre class="text-sm text-gray-800"><code>{{ JSON.stringify(jsonPayload, null, 2) }}</code></pre>
          <p class="text-xs text-gray-500 mt-1">Overrides: {{ overridesCode }}</p>
        </div>

        <!-- Platform outputs -->
        <div class="grid md:grid-cols-2 gap-4">
          <div class="bg-white border p-4 rounded">
            <div class="flex justify-between items-center mb-1">
              <h3 class="font-semibold">üì± Swift (iOS)</h3>
              <button @click="copyToClipboard(swiftCode, 'Swift')" class="text-blue-600 text-sm hover:underline">Copy</button>
            </div>
            <pre class="text-sm text-gray-800"><code>{{ swiftCode }}</code></pre>
          </div>

          <div class="bg-white border p-4 rounded">
            <div class="flex justify-between items-center mb-1">
              <h3 class="font-semibold">ü§ñ Kotlin / Java (Android)</h3>
              <button @click="copyToClipboard(kotlinCode, 'Kotlin')" class="text-blue-600 text-sm hover:underline">Copy</button>
            </div>
            <pre class="text-sm text-gray-800"><code>{{ kotlinCode }}</code></pre>
          </div>

          <div class="bg-white border p-4 rounded md:col-span-2">
            <div class="flex justify-between items-center mb-1">
              <h3 class="font-semibold">‚öõÔ∏è React Native</h3>
              <button @click="copyToClipboard(reactNativeCode, 'React Native')" class="text-blue-600 text-sm hover:underline">Copy</button>
            </div>
            <pre class="text-sm text-gray-800"><code>{{ reactNativeCode }}</code></pre>
          </div>
        </div>
        <p v-if="copied" class="text-green-600 text-sm">{{ copied }}</p>
      </div>
    `
  }).mount('#root');
</script>
</body>
<!-- Syncs GA session ID to PostHog for identity resolution -->
<script>
  (function () {
    function getGASessionId() {
      const gaCookie = document.cookie.split('; ').find(row => row.startsWith('_ga='));
      if (!gaCookie) return null;
      const parts = gaCookie.split('.');
      if (parts.length < 4) return null;
      return `${parts[2]}.${parts[3]}`;
    }

    const sessionId = getGASessionId();
    if (sessionId && window.posthog) {
      console.log('[PostHog] Registered GA session ID:', sessionId);
      posthog.register({ ga_session_id: sessionId });
      posthog.capture('pageview_with_ga_session', { ga_session_id: sessionId });
    }
  })();
</script>
</html>
